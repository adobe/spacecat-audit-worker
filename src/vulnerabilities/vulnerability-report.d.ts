/**
 * Type definitions for vulnerability reports
 */

/**
 * Represents a vulnerability severity level
 */
export type VulnerabilitySeverity = 'Critical' | 'High' | 'Medium' | 'Low';

/**
 * Represents an individual vulnerability
 */
export interface Vulnerability {
  /** Unique identifier for the vulnerability (e.g., CVE-2020-36518) */
  id: string;
  /** CVSS score or numeric severity score */
  score: number;
  /** Severity level of the vulnerability */
  severity: VulnerabilitySeverity;
  /** Human-readable description of the vulnerability */
  description: string;
  /** URL with more information about the vulnerability (may be empty) */
  url: string;
}

/**
 * Represents a vulnerable component with its associated vulnerabilities
 */
export interface VulnerableComponent {
  /** Full name of the component (e.g., "com.fasterxml.jackson.core:jackson-databind") */
  name: string;
  /** Current version of the component */
  version: string;
  /** Recommended version to fix vulnerabilities */
  recommendedVersion: string;
  /** File system path where the component is located */
  path: string;
  /** Array of vulnerabilities found in this component */
  vulnerabilities: Vulnerability[];
}

/**
 * Summary statistics for the vulnerability report
 */
export interface VulnerabilityReportSummary {
  /** Total number of components analyzed */
  totalComponents: number;
  /** Total number of vulnerabilities found */
  totalVulnerabilities: number;
  /** Number of critical severity vulnerabilities */
  criticalVulnerabilities: number;
  /** Number of high severity vulnerabilities */
  highVulnerabilities: number;
  /** Number of medium severity vulnerabilities */
  mediumVulnerabilities: number;
  /** Number of low severity vulnerabilities */
  lowVulnerabilities: number;
}

/**
 * Main vulnerability report structure
 */
export interface VulnerabilityReport {
  /** Summary statistics of the vulnerability scan */
  summary: VulnerabilityReportSummary;
  /** Array of components that contain vulnerabilities */
  vulnerableComponents: VulnerableComponent[];
}
